<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>음운의 변동</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
    }
    .title {
      font-size: 24px;
      font-weight: bold;
    }
    .subtitle {
      font-size: 18px;
      margin-top: 10px;
    }
    .box {
      border: 2px solid #000;
      padding: 15px;
      margin-top: 20px;
      background-color: #f5f5f5;
    }
    .question, .timer {
      margin-top: 20px;
      font-weight: bold;
    }
    .result {
      margin-top: 20px;
      font-size: 18px;
      color: darkblue;
    }
    .hidden {
      display: none;
    }
    #popup {
      position: fixed;
      top: 30%;
      left: 30%;
      width: 300px;
      background: white;
      border: 2px solid black;
      padding: 20px;
      text-align: center;
      display: none;
      z-index: 100;
    }
    #overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      z-index: 99;
    }
  </style>
</head>
<body>

  <div class="title">타이틀: 음운의 변동</div>
  <div class="subtitle">대상 및 교과: 고등학교 1학년</div>

  <div class="box">
    문제: 음운의 변동의 종류에는 ‘교체, 탈락, 축약, 첨가’가 있다. 예시를 보고 흐름도에 따라 판단해보세요.
  </div>

  <div class="box">
    시간 설정:
    <select id="timeSelect">
      <option value="30">30초</option>
      <option value="60">1분</option>
      <option value="90">1분 30초</option>
      <option value="120">2분</option>
    </select>
    <button onclick="startQuiz()">문제 풀이 시작</button>
  </div>

  <div class="box hidden" id="quizBox">
    <div><strong>예시 단어:</strong> <span id="exampleWord"></span></div>
    <div class="timer">남은 시간: <span id="timer">00:00</span></div>

    <div class="question" id="q1">음운의 개수에 변동이 있습니까?</div>
    <button onclick="answer('no')">아니오</button>
    <button onclick="answer('yes1')">예</button>

    <div class="question hidden" id="q2">음운의 개수가 감소하였습니까?</div>
    <button onclick="answer('no2')" id="btn2-1" class="hidden">아니오</button>
    <button onclick="answer('yes2')" id="btn2-2" class="hidden">예</button>

    <div class="question hidden" id="q3">제3의 음운으로 바뀌었습니까?</div>
    <button onclick="answer('no3')" id="btn3-1" class="hidden">아니오</button>
    <button onclick="answer('yes3')" id="btn3-2" class="hidden">예</button>

    <div class="result" id="result"></div>
  </div>

  <!-- 팝업 -->
  <div id="overlay"></div>
  <div id="popup">
    <p>시간이 종료되었습니다!</p>
    <button onclick="retryQuiz()">다시 도전</button>
  </div>

  <script>
    const examples = [
      { word: "국수 → [국쑤]", answer: "no" },     // 교체
      { word: "낳은 → [나은]", answer: "yes2" },    // 탈락
      { word: "국화 → [구콰]", answer: "yes3" },    // 축약
      { word: "담요 → [담뇨]", answer: "no3" }      // 첨가
    ];

    let timer, countdown, currentAnswer;

    function startQuiz() {
      document.getElementById("quizBox").classList.remove("hidden");
      document.getElementById("result").innerText = "";

      // 랜덤 예시 선택
      const random = examples[Math.floor(Math.random() * examples.length)];
      document.getElementById("exampleWord").innerText = random.word;
      currentAnswer = random.answer;

      // 모든 질문 숨기기 초기화
      hideAllQuestions();
      document.getElementById("q1").style.display = "block";

      // 타이머 시작
      let selectedTime = parseInt(document.getElementById("timeSelect").value);
      startTimer(selectedTime);
    }

    function hideAllQuestions() {
      ["q2", "q3", "btn2-1", "btn2-2", "btn3-1", "btn3-2"].forEach(id => {
        document.getElementById(id).classList.add("hidden");
      });
    }

    function answer(choice) {
      if (choice === currentAnswer) {
        document.getElementById("result").innerText = "정답입니다!";
        clearInterval(countdown);
      } else {
        if (choice === "yes1") {
          document.getElementById("q2").classList.remove("hidden");
          document.getElementById("btn2-1").classList.remove("hidden");
          document.getElementById("btn2-2").classList.remove("hidden");
        } else if (choice === "no2") {
          document.getElementById("q3").classList.remove("hidden");
          document.getElementById("btn3-1").classList.remove("hidden");
          document.getElementById("btn3-2").classList.remove("hidden");
        } else if (choice.startsWith("yes") || choice.startsWith("no")) {
          document.getElementById("result").innerText = "틀렸습니다. 다시 시도해보세요!";
        }
      }
    }

    function startTimer(duration) {
      let timeLeft = duration;
      updateTimerDisplay(timeLeft);
      countdown = setInterval(() => {
        timeLeft--;
        updateTimerDisplay(timeLeft);
        if (timeLeft <= 0) {
          clearInterval(countdown);
          showPopup();
        }
      }, 1000);
    }

    function updateTimerDisplay(seconds) {
      const m = String(Math.floor(seconds / 60)).padStart(2, '0');
      const s = String(seconds % 60).padStart(2, '0');
      document.getElementById("timer").innerText = `${m}:${s}`;
    }

    function showPopup() {
      document.getElementById("overlay").style.display = "block";
      document.getElementById("popup").style.display = "block";
    }

    function hidePopup() {
      document.getElementById("overlay").style.display = "none";
      document.getElementById("popup").style.display = "none";
    }

    function retryQuiz() {
      hidePopup();
      startQuiz();
    }
  </script>

</body>
</html>
